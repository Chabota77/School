<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tuition Payments | Admin</title>
  <link rel="stylesheet" href="../css/admin-dashboard.css">
</head>

<body>

  <!-- MOBILE SIDEBAR TOGGLE -->
  <input type="checkbox" id="sidebar-toggle" class="sidebar-toggle">
  <label for="sidebar-toggle" class="sidebar-icon">â˜°</label>
  <label for="sidebar-toggle" class="sidebar-overlay"></label>

  <!-- SIDEBAR (same as admin dashboard) -->
  <aside class="admin-sidebar">
    <div class="admin-logo">Admin Panel</div>
    <nav>
      <a href="dashboard.html">Dashboard</a>
      <a href="dashboard.html#teachers">Teachers</a>
      <a href="students.html">Students</a>
      <a href="dashboard.html#announcement">Announcements</a>
      <a href="payments.html" class="active">View Tuition Payments</a>
      <a href="dashboard.html#admissions">Admissions</a>
      <a href="dashboard.html#gallery-mgmt">ðŸŽ¨ Gallery</a>
      <a href="dashboard.html#results-mgmt">ðŸ“Š Results</a>
      <a href="dashboard.html#reports">Reports</a>
      <a href="dashboard.html#logs">System Logs</a>
      <a href="../login.html" id="logoutBtn">Logout</a>
    </nav>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="admin-main">
    <header class="admin-header">
      <h1>Tuition Fee Payments</h1>
      <p>Overview of all payments made by students</p>
    </header>

    <!-- MONTH SELECTOR (UI ONLY) -->
    <section class="month-selector">
      <div class="month-left">
        <label for="month">Select Month</label>
        <select id="month">
          <option value="0">January</option>
          <option value="1">February</option>
          <option value="2">March</option>
          <option value="3">April</option>
          <option value="4">May</option>
          <option value="5">June</option>
          <option value="6">July</option>
          <option value="7">August</option>
          <option value="8">September</option>
          <option value="9">October</option>
          <option value="10">November</option>
          <option value="11">December</option>
        </select>
      </div>

      <div class="month-right">
        <label for="year-select" style="display:block; font-size:13px; color:#555; margin-bottom:5px;">Year</label>
        <select id="year-select"
          style="padding: 10px 14px; border-radius: 8px; border: 1px solid #ccc; font-size: 14px; cursor: pointer;">
          <!-- Populated by JS -->
          <option value="2026">2026</option>
        </select>
      </div>
    </section>

    <!-- MONTHLY PAYMENT SUMMARY -->
    <section class="payment-summary">
      <div class="summary-card">
        <h3>ZMW 0.00</h3>
        <p>Total Collected<br><span>This Month</span></p>
      </div>

      <div class="summary-card warning">
        <h3>ZMW 0.00</h3>
        <p>Outstanding<br><span>Balances</span></p>
      </div>

      <div class="summary-card success">
        <h3>0</h3>
        <p>Fully Paid<br><span>Students</span></p>
      </div>

      <div class="summary-card danger">
        <h3>0</h3>
        <p>Unpaid / Partial<br><span>Students</span></p>
      </div>
    </section>

    <!-- FILTER SECTION (UI only) -->
    <section class="payment-filters">
      <input type="text" placeholder="Search student name">
      <select>
        <option>All Classes</option>
        <!-- Dynamic -->
      </select>
      <select>
        <option>All Status</option>
        <option>Paid</option>
        <option>Partial</option>
        <option>Unpaid</option>
      </select>
    </section>

    <!-- PAYMENTS TABLE -->
    <section class="payments-table">
      <table>
        <thead>
          <tr>
            <th>Student Name</th>
            <th>Class</th>
            <th>Total Fees</th>
            <th>Amount Paid</th>
            <th>Balance</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Dynamic Content -->
        </tbody>
      </table>
    </section>

    <!-- ADD PAYMENT MODAL -->
    <div id="addPaymentModal" class="modal-overlay" style="display: none;">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>Record Payment</h3>
        <form id="paymentForm">
          <input type="hidden" id="payStudentId">
          <input type="hidden" id="payTransactionId">
          <label>Student Name</label>
          <input type="text" id="payStudentName" disabled style="background:#eee;">

          <label>Amount (ZMW)</label>
          <input type="number" id="payAmount" placeholder="e.g. 500" required>

          <label>Date</label>
          <input type="date" id="payDate" required>

          <label>Payment Method</label>
          <select id="payMethod">
            <option>Cash</option>
            <option>Bank Transfer</option>
            <option>Mobile Money</option>
          </select>

          <button type="submit" class="btn primary" style="width:100%; margin-top:15px;">Save Payment</button>
        </form>
      </div>
    </div>

    <!-- PAYMENT HISTORY MODAL -->
    <div id="historyModal" class="modal-overlay" style="display: none;">
      <div class="modal-content" style="max-width: 600px;">
        <span class="close-modal">&times;</span>
        <h3 id="historyStudentName">Payment History</h3>
        <table id="historyTable" style="width:100%; margin-top:10px; border-collapse: collapse;">
          <thead>
            <tr style="background:#f3f4f6;">
              <th style="padding:10px; text-align:left;">Date</th>
              <th style="padding:10px; text-align:left;">Amount</th>
              <th style="padding:10px; text-align:left;">Method</th>
              <th style="padding:10px; text-align:left;">Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Transactions -->
          </tbody>
        </table>
      </div>
    </div>

    <style>
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .modal-content {
        background: white;
        padding: 25px;
        border-radius: 8px;
        width: 400px;
        position: relative;
      }

      .close-modal {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        cursor: pointer;
      }

      .btn.edit {
        background: #10b981;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
      }

      .btn.message {
        background: #3b82f6;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
      }
    </style>
  </main>

  <script src="../js/data.js"></script>
  <script src="../js/utils.js"></script>
  <script src="../js/auth.js"></script>
  <script src="../js/admin-payments-fixed.js?v=FIXED"></script>
  <script>
    document.getElementById('logoutBtn')?.addEventListener('click', (e) => {
      e.preventDefault();
      window.SchoolAuth.logout();
    });
  </script>
</body>

</html>